<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_variante_devis_parametrable">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="web.external_layout">
                    <div class="page">

                        <style>
                            body {
                                line-height: 1.2;
                            }

                            h1{
                                font-size: 14pt;
                                font-weight:bold;
                            }
                            h2{
                                font-size: 13pt;
                                font-weight:bold;
                            }
                            h3{
                                font-size: 12pt;
                                font-weight:bold;
                            }
                            .table-sm th, .table-sm td {
                                padding: 0.1rem;
                                padding-left:0.5em;
                                padding-right:0.5em;
                            }
                        </style>

                        <h1><span t-field="o.quantite"/> x <span t-field="o.devis_id.designation"/></h1>
                        <h2><span t-field="o.devis_id.designation_complementaire"/></h2>
                    
                        <table class="table table-sm o_main_table">
                            <thead>
                                <tr>
                                    <th class="text-center">Inox</th>
                                    <th class="text-center">Type</th>
                                    <th class="text-center">Finition intérieur</th>
                                    <th class="text-center">Finition exterieur</th>
                                    <th class="text-center">Ep.</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="o.devis_id.matiere_ids" t-as="l">
                                    <tr t-if="l.imprimer">
                                        <td class="text-left">  <span t-field="l.section_id.name"/></td>
                                        <td class="text-center"><span t-field="l.matiere_id.type_matiere"/></td>
                                        <td class="text-center"><span t-field="l.matiere_id.finition_interieur"/></td>
                                        <td class="text-center"><span t-field="l.matiere_id.finition"/></td>
                                        <td class="text-right"> <span t-field="l.epaisseur"/>mm</td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>

                        <h3>Dimensions : </h3>
                        <table class="table table-sm o_main_table">
                            <tbody>
                                <t t-foreach="o.devis_id.dimension_ids" t-as="l">
                                    <t t-if="l.imprimer">
                                        <tr>
                                            <td class="text-left">  <span t-field="l.dimension_id.name"/></td>
                                            <td class="text-left">
                                                <span t-field="l.valeur"/><span t-field="l.unite_id.name"/>
                                                <span t-field="l.description"/>
                                            </td>
                                        </tr>
                                    </t>
                                </t>
                            </tbody>
                        </table>


                        <h3>Equipements : </h3>
                        <table class="table table-sm o_main_table">
                            <tbody>
                                <t t-foreach="o.devis_id.section_ids" t-as="section">
                                    <tr style="border-bottom: 1px solid;">
                                        <td class="text-left"><span t-field="section.section_id.name"/></td>
                                        <td class="text-left">

                                            <t t-foreach="section.product_ids" t-as="l">
                                                <div t-field="l.description_report"/>
                                            </t>
                                        
                                        </td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                        <t t-if="o.devis_id.montant_option_thermo">
                            <h3>Thermorégulation : </h3>
                            <table class="table table-sm o_main_table">
                                <tbody>
                                    <t t-foreach="o.devis_id.options_ids" t-as="option">
                                        <tr t-if="option.option_active and option.thermoregulation" style="border-bottom: 1px solid;">
                                            <td class="text-left">  <span t-field="option.description_client"/></td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </t>
                        <t t-if="(o.devis_id.montant_option_comprise-o.devis_id.montant_option_thermo)>0">
                            <h3>Options comprises : </h3>
                            <table class="table table-sm o_main_table">
                                <tbody>
                                    <t t-foreach="o.devis_id.options_ids" t-as="option">
                                        <tr t-if="option.option_active and option.option_comprise and not option.thermoregulation" style="border-bottom: 1px solid;">
                                            <td class="text-left"> <span t-field="option.description_client"/></td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </t>
                        <div class="row">
                            <div class="col-6 ml-auto">
                                <table class="table table-sm o_main_table" style="page-break-inside: avoid;">
                                    <tr>
                                        <td><strong>Prix unitaire HT</strong></td>
                                        <td class="text-right" style="width:40mm"><span t-field="o.prix_vente_int"/> €</td>
                                    </tr>
                                    <t t-if="o.montant_remise">
                                        <tr>
                                            <td><strong><span t-field="o.intitule_remise"/></strong></td>
                                            <td class="text-right"><span t-field="o.montant_remise"/> €</td>
                                        </tr>
                                        <tr>
                                            <td><strong>Prix unitaire avec remise HT</strong></td>
                                            <td class="text-right"><span t-field="o.prix_vente_remise"/> €</td>
                                        </tr>
                                    </t>
                                    <!-- <tr>
                                        <td><strong>TVA</strong></td>
                                        <td class="text-right"><span t-field="o.montant_tva"/> €</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Prix unitaire TTC</strong></td>
                                        <td class="text-right"><span t-field="o.prix_vente_ttc"/> €</td>
                                    </tr> -->
                                </table>
                                <div t-if="o.afficher_prix_par_hl" style="font-style: italic;">
                                    Prix par HL : <span t-field="o.prix_par_hl"/> €
                                </div>
                            </div>
                        </div>
                        <t t-if="(o.devis_id.montant_option_active-o.devis_id.montant_option_comprise)>0">
                            <h3>Autres Options non comprises : </h3>
                            <table class="table table-sm o_main_table">
                                <tbody>
                                    <t t-foreach="o.devis_id.options_ids" t-as="option">
                                        <tr t-if="option.option_active and not option.option_comprise " style="border-bottom: 1px solid;">
                                            <td class="text-left">  <span t-field="option.description_client"/></td>
                                            <!-- <td class="text-right" style="width:40mm"><span t-field="option.montant_int"/> € HT</td> -->
                                            <td class="text-right" style="width:40mm"><span t-esc="o.get_montant_option(option)"/> € HT</td>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </t>
                    </div>
                </t>
            </t>
        </t>
    </template>


    <template id="report_devis_parametrable_affaire">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="web.external_layout">
                    <style>
                        h3{
                            font-size:14pt;
                            font-weight:bold;
                            padding:0;
                            margin:0;
                            margin-bottom:1mm;
                            margin-top:3mm;
                        }
                    </style>

                    <div class="page">

                        <h3>Récapitulatif de l'offre</h3>
                        <table class="table table-sm o_main_table">
                            <thead>
                                <tr>
                                    <th class="text-left">Description</th>
                                    <th class="text-center">Capacité</th>
                                    <th class="text-right">Prix unitaire</th>
                                    <th class="text-center">Quantité prévue</th>
                                    <th class="text-right">Montant HT</th>
                                </tr>
                            </thead>
                            <tbody>
                                <t t-foreach="o.variante_ids" t-as="variante">
                                    <tr style="border-bottom: 1px solid;">
                                        <td class="text-left"><span t-field="variante.variante_id.devis_id.designation"/></td>
                                        <td class="text-center"><span t-field="variante.variante_id.devis_id.capacite_txt"/></td>
                                        <td class="text-right"><span t-field="variante.variante_id.prix_vente_remise"/> €</td>
                                        <td class="text-center"><span t-field="variante.variante_id.quantite"/></td>
                                        <td t-if="variante.quantite>0"  class="text-right"><span t-field="variante.variante_id.prix_vente_lot"/></td>
                                        <td t-if="variante.quantite==0" class="text-right">0,00 €</td>
                                    </tr>
                                </t>
                            </tbody>
                        </table>
                        <div class="row">
                            <div class="col-6 ml-auto">
                                <table class="table table-sm o_main_table" style="page-break-inside: avoid;">
                                    <tr>
                                        <td><strong>Total HT</strong></td>
                                        <td class="text-right"><span t-field="o.montant_ht"/></td>
                                    </tr>
                                    <tr>
                                        <td><strong>TVA</strong></td>
                                        <td class="text-right"><span t-field="o.montant_tva"/></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Total TTC</strong></td>
                                        <td class="text-right"><span t-field="o.montant_ttc"/></td>
                                    </tr>
                                </table>
                                <div t-if="o.capacite" style="font-style: italic;">
                                    Capacité totale de <span t-field="o.capacite"/>HL soit <span t-field="o.prix_par_hl"/> € HT par HL
                                </div>
                            </div>
                        </div>
                        <t t-if="o.conditions_particulieres">
                            <h3>Conditions particulières</h3>
                            <div t-field="o.conditions_particulieres"/>
                        </t>
                        <t t-if="o.information_technique">
                            <h3>Informations techniques</h3>
                            <div t-field="o.information_technique"/>
                        </t>
                        <t t-if="o.information_complementaire">
                            <h3>Informations complémentaires</h3>
                            <div t-field="o.information_complementaire"/>
                        </t>
                        <t t-if="o.conditions_reglement">
                            <h3>Conditions de règlement</h3>
                            <div t-field="o.conditions_reglement"/>
                        </t>
                        <t t-if="o.delais">
                            <h3>Délais</h3>
                            <div t-field="o.delais"/>
                        </t>
                        <t t-if="o.duree_validite">
                            <h3>Durée de validité de l'offre</h3>
                            <div t-field="o.duree_validite"/>
                        </t>
                        <t t-if="o.transport">
                            <h3>Transport</h3>
                            <div t-field="o.transport"/>
                        </t>
                        <t t-if="o.conditions_generales">
                            <h3>Conditions générales de ventes</h3>
                            <div t-field="o.conditions_generales"/>
                        </t>
                        <t t-if="o.vendeur_id">
                            <h3>Chargé d'affaire</h3>
                            <div t-field="o.vendeur_id"/>
                        </t>
                        <t t-if="o.date_modification">
                            <div>Fait à Saint-Amour le <span t-field="o.date_modification"/></div>
                        </t>
                        <img t-if="o.vendeur_id.is_image_signature" t-att-src="image_data_uri(o.vendeur_id.is_image_signature)" style="max-height: 25mm;"/>
                        <div style="text-align:center;margin-top:5mm">
                            <img src='/is_bsa14/static/src/img/made-in-jura.jpg' style="height:30mm" />
                        </div>
                    </div>
                </t>
            </t>
        </t>
    </template>



    <template id="report_devis_parametrable_affaire_entete">
        <t t-call="web.html_container">
            <t t-foreach="docs" t-as="o">
                <t t-call="web.external_layout">
                    <div class="page">
                        <style>
                            .o_report_layout_boxed .page > table:not(.o_main_table) tr td:last-child {
                                background-color: white;
                            }
                            .o_report_layout_boxed table tbody tr td {
                                border-right: none;
                            }
                            th, td {
                                padding: 0.2rem;
                                padding-left:0;
                                line-height: 1.1;
                                background-color : white;
                                color:black;
                                font-size:12pt;
                                vertical-align: top;
                            }
                            td {
                                white-space: nowrap;
                            }
                        </style>
                        <t t-if="o.is_societe_commerciale_id.id">
                            <div style="text-align:center">
                                <img 
                                    t-if="o.is_societe_commerciale_id.logo" 
                                    t-att-src="image_data_uri(o.is_societe_commerciale_id.logo)" 
                                    style="max-height:25mm;max-width:80mm;"
                                />
                                <div style="margin-top:1mm;font-size:11pt" t-field="o.is_societe_commerciale_id.slogan"/>
                                <div style="margin-top:5mm;font-size:22pt;font-weight:bold;color:black">Offre de prix</div>
                            </div>
                        </t>
                        <br />
                        <table style="width:100%;border:none; border-top:1px solid black">
                            <tr>
                                <th style="width:35mm">Client : </th>
                                <th style="font-size:14pt"><span t-field="o.partner_id.name"/></th>
                                <t t-if="o.partner_id.image_1920">
                                    <td rowspan="3" style="width:10mm;text-align:right">
                                        <img  t-att-src="image_data_uri(o.partner_id.image_1920)" style="max-width:100mm;max-height:60mm;"/>
                                    </td>
                                </t>
                            </tr>
                            <tr>
                                <th>À l'attention de : </th>
                                <td><span t-field="o.attention_de"/></td>
                            </tr>
                            <tr>
                                <th>Adresse : </th>
                                <td>
                                    <div t-field="o.partner_id.street"/>
                                    <div t-if="o.partner_id.street2" t-field="o.partner_id.street2"/>
                                    <span t-field="o.partner_id.zip"/> <span t-field="o.partner_id.city"/>
                                </td>
                            </tr>
                        </table>
                        <div style="height:10mm"/>
                        <table style="width:100%;border:none; border-top:1px solid black">
                            <tr>
                                <th style="width:35mm;color:black">Devis N° : </th>
                                <th style="font-size:14pt"><span t-field="o.code_affare"/></th>
                                <t t-if="o.image_affaire">
                                    <td rowspan="5" style="width:10mm;text-align:right">
                                        <img  t-att-src="image_data_uri(o.image_affaire)" style="max-width:100mm;max-height:60mm;"/>
                                    </td>
                                </t>
                            </tr>
                            <tr>
                                <th>Affaire : </th>
                                <td><span t-field="o.name"/></td>
                            </tr>
                            <tr>
                                <th>Date : </th>
                                <td><span t-field="o.date_modification"/></td>
                            </tr>
                            <tr>
                                <th>Version : </th>
                                <td><span t-field="o.version"/></td>
                            </tr>
                            <tr>
                                <th>Chargé d'affaire : </th>
                                <td><span t-field="o.vendeur_id.name"/></td>
                            </tr>
                        </table>
                        <div style="height:5mm"/>
                        <div style="text-align:center;border-top: 1px solid black;border-bottom:1px solid black;">
                            <div style="padding:2mm;font-size:22pt;font-weight:bold;color:black">Descriptif de l'affaire</div>
                        </div>
                        <div style="font-size:13pt;text-align:left;color:black;font-weight:bold;">
                            <t t-foreach="o.variante_ids" t-as="variante">
                                <div style="padding-top:5mm;padding-left:33mm">
                                    - <span t-field="variante.variante_id.quantite"/> x 
                                    <span t-field="variante.variante_id.devis_id.designation"/>
                                </div>
                            </t>
                        </div>
                        <div style="text-align:center;margin-top:10mm">
                            <img src='/is_bsa14/static/src/img/made-in-jura.jpg' style="height:30mm" />
                        </div>
                    </div>
                </t>
            </t>
        </t>
    </template>


</odoo>
